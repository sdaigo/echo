# セキュリティ原則

プロジェクト共通のセキュリティ原則。プロジェクト固有の要件は `docs/` を参照。

## 入力バリデーション

- 全ての外部入力（API、フォーム、URL パラメータ）をバリデーションする
- バリデーションはできるだけ早い段階で行う（API境界）
- 許可リスト方式を優先する（拒否リストではなく）

## 認証・認可

- APIエンドポイントには必ず認証チェックを設ける
- リソースアクセスには認可チェック（所有者確認）を行う
- セッション管理: httpOnly, Secure, SameSite属性を設定

## 機密情報

- シークレット（APIキー、トークン、パスワード）をコードにハードコードしない
- 環境変数またはシークレットマネージャーを使用する
- `.env` ファイルは `.gitignore` に含める
- ログに機密情報を出力しない
- エラーレスポンスに内部情報を露出しない

## OWASP Top 10 対策

- **インジェクション**: ORM経由のみ、生SQL禁止
- **認証の不備**: セッション管理、パスワードハッシュ
- **機密データの露出**: 最小限のデータ返却、暗号化
- **XSS**: ユーザー入力のサニタイゼーション、CSP設定
- **CSRF**: トークンベースの防御
- **セキュリティ設定の不備**: デフォルトの変更、不要な機能の無効化

## 依存関係

- 定期的に依存パッケージの脆弱性をチェックする
- 既知の脆弱性がある依存関係は速やかに更新する
